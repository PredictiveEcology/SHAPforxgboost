<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>A wrapped function to make summary plot from given SHAP values matrix — shap.plot.summary.wrap2 • SHAPforxgboost</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="A wrapped function to make summary plot from given SHAP values matrix — shap.plot.summary.wrap2" />
<meta property="og:description" content="shap.plot.summary.wrap2 wraps up function shap.prep and
shap.plot.summary. Since SHAP matrix could be returned from
cross-validation instead of only one model, here the wrapped
shap.prep takes the SHAP score matrix shap_score as input" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SHAPforxgboost</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/lightgbm.html">Using SHAPforxgboost with LightGBM</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/liuyanguu/SHAPforxgboost/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>A wrapped function to make summary plot from given SHAP values matrix</h1>
    <small class="dont-index">Source: <a href='https://github.com/liuyanguu/SHAPforxgboost/blob/master/R/SHAP_funcs.R'><code>R/SHAP_funcs.R</code></a></small>
    <div class="hidden name"><code>shap.plot.summary.wrap2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>shap.plot.summary.wrap2</code> wraps up function <code><a href='shap.prep.html'>shap.prep</a></code> and
<code><a href='shap.plot.summary.html'>shap.plot.summary</a></code>. Since SHAP matrix could be returned from
cross-validation instead of only one model, here the wrapped
<code><a href='shap.prep.html'>shap.prep</a></code> takes the SHAP score matrix <code>shap_score</code> as input</p>
    </div>

    <pre class="usage"><span class='fu'>shap.plot.summary.wrap2</span><span class='op'>(</span><span class='va'>shap_score</span>, <span class='va'>X</span>, <span class='va'>top_n</span>, dilute <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>shap_score</th>
      <td><p>the SHAP values dataset, could be obtained by
<code>shap.prep</code></p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>the dataset of predictors used for calculating SHAP values</p></td>
    </tr>
    <tr>
      <th>top_n</th>
      <td><p>how many predictors you want to show in the plot (ranked)</p></td>
    </tr>
    <tr>
      <th>dilute</th>
      <td><p>being numeric or logical (TRUE/FALSE), it aims to help make the test
plot for large amount of data faster. If dilute = 5 will plot 1/5 of the
data. If dilute = TRUE or a number, will plot at most half points per
feature, so the plotting won't be too slow. If you put dilute too high, at
least 10 points per feature would be kept. If the dataset is too small
after dilution, will just plot all the data</p></td>
    </tr>
    </table>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"iris"</span><span class='op'>)</span>
<span class='va'>X1</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>mod1</span> <span class='op'>=</span> <span class='fu'>xgboost</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/xgboost/man/xgb.train.html'>xgboost</a></span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>X1</span>, label <span class='op'>=</span> <span class='va'>iris</span><span class='op'>$</span><span class='va'>Species</span>, gamma <span class='op'>=</span> <span class='fl'>0</span>, eta <span class='op'>=</span> <span class='fl'>1</span>,
  lambda <span class='op'>=</span> <span class='fl'>0</span>, nrounds <span class='op'>=</span> <span class='fl'>1</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'># shap.values(model, X_dataset) returns the SHAP</span>
<span class='co'># data matrix and ranked features by mean|SHAP|</span>
<span class='va'>shap_values</span> <span class='op'>&lt;-</span> <span class='fu'><a href='shap.values.html'>shap.values</a></span><span class='op'>(</span>xgb_model <span class='op'>=</span> <span class='va'>mod1</span>, X_train <span class='op'>=</span> <span class='va'>X1</span><span class='op'>)</span>
<span class='va'>shap_values</span><span class='op'>$</span><span class='va'>mean_shap_score</span>
</div><div class='output co'>#&gt; Petal.Length  Petal.Width Sepal.Length  Sepal.Width 
#&gt;   0.62935975   0.21664035   0.02910357   0.00000000 </div><div class='input'><span class='va'>shap_values_iris</span> <span class='op'>&lt;-</span> <span class='va'>shap_values</span><span class='op'>$</span><span class='va'>shap_score</span>

<span class='co'># shap.prep() returns the long-format SHAP data from either model or</span>
<span class='va'>shap_long_iris</span> <span class='op'>&lt;-</span> <span class='fu'><a href='shap.prep.html'>shap.prep</a></span><span class='op'>(</span>xgb_model <span class='op'>=</span> <span class='va'>mod1</span>, X_train <span class='op'>=</span> <span class='va'>X1</span><span class='op'>)</span>
<span class='co'># is the same as: using given shap_contrib</span>
<span class='va'>shap_long_iris</span> <span class='op'>&lt;-</span> <span class='fu'><a href='shap.prep.html'>shap.prep</a></span><span class='op'>(</span>shap_contrib <span class='op'>=</span> <span class='va'>shap_values_iris</span>, X_train <span class='op'>=</span> <span class='va'>X1</span><span class='op'>)</span>

<span class='co'># **SHAP summary plot**</span>
<span class='fu'><a href='shap.plot.summary.html'>shap.plot.summary</a></span><span class='op'>(</span><span class='va'>shap_long_iris</span>, scientific <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='shap.plot.summary.wrap2-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='shap.plot.summary.html'>shap.plot.summary</a></span><span class='op'>(</span><span class='va'>shap_long_iris</span>, x_bound  <span class='op'>=</span> <span class='fl'>1.5</span>, dilute <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
</div><div class='img'><img src='shap.plot.summary.wrap2-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Alternatives options to make the same plot:</span>
<span class='co'># option 1: from the xgboost model</span>
<span class='fu'><a href='shap.plot.summary.wrap1.html'>shap.plot.summary.wrap1</a></span><span class='op'>(</span><span class='va'>mod1</span>, X <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span>, top_n <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='img'><img src='shap.plot.summary.wrap2-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># option 2: supply a self-made SHAP values dataset</span>
<span class='co'># (e.g. sometimes as output from cross-validation)</span>
<span class='fu'>shap.plot.summary.wrap2</span><span class='op'>(</span>shap_score <span class='op'>=</span> <span class='va'>shap_values_iris</span>, X <span class='op'>=</span> <span class='va'>X1</span>, top_n <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='img'><img src='shap.plot.summary.wrap2-4.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Yang Liu, Allan Just.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


